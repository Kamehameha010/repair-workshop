
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<div class="row" style="text-align:right; padding:5px;">
    <div class="form-group">
        <a class="btn btn-primary" href="~/Cliente/Crear">Crear</a>
    </div>
</div>
<div class="row" >
    <div class="col-md-12" id="ListaCliente">

    </div>
</div>

@section Scripts {

    <script type="text/javascript">
        ListadoClientes();
        function ListadoClientes() {
            fetch("/Cliente/ListadoClientes")
                .then(response => {
                    if (response.ok)
                        return response.json()
                    else
                        throw new Error("Ha ocurrido un error. Intente de nuevo.");
                }).then(data => {
                    let res = "";
                    let fila = 1;
                    let urlE = "";
                    res += "<table class='table'><tr><th>#</th><th>Nombre</th>\
                <th>Apellidos</th><th>Cédula</th><th>Teléfono</th><th>Correo</th>\
                <th>Editar</th><th>Eliminar</th></tr>";

                    for (var i of data) {
                        urlE = 'document.location.href = "/Cliente/Editar/?id=' + i.Id + '"';
                        urlD = 'document.location.href = "/Cliente/Eliminar/?id=' + i.Id + '"';
                        urlF = 'location.assign("/Cliente/Prueba/?id=' + i.Id + '")';
                        res += "<tr><td>" + fila + "</td>\
                        <td>" + i.Nombre + "</td>\
                        <td>" + i.Apellidos + "</td>\
                        <td>" + i.Cedula + "</td>\
                        <td>" + i.Telefono + "</td>\
                        <td>" + i.Correo + "</td>\
                        <td><input class='btn btn-success' type='button' value='Editar' onclick='"+ urlE +"'/></td>\
                        <td><input class='btn btn-danger' type='button' value='Eliminar' onclick='"+ urlD +"'/></td>\
                        <td><input class='btn btn-danger' type='button' value='Prueba' onclick='"+ urlF +"'/></td>\
                        </tr > "
                        fila++;
                    }
                    res += "</table>"
                    document.getElementById("ListaCliente").innerHTML = res;

                })
        }



    </script>
}
