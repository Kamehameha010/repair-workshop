@model Sistema_Taller.Models.Usuario
@{
    ViewBag.Title = "Eliminar";
}

<h2>Eliminar</h2>

<div class="row">
    <dl class="dl-horizontal">
        
        <dt>@Html.DisplayNameFor(m => m.nombre)</dt>
        <dd>@Html.DisplayFor(m => m.nombre)</dd>

        <dt>@Html.DisplayNameFor(m => m.apellidos)</dt>
        <dd>@Html.DisplayFor(m => m.apellidos)</dd>

        <dt>@Html.DisplayNameFor(m => m.cedula)</dt>
        <dd>@Html.DisplayFor(m => m.cedula)</dd>

        <dt>@Html.DisplayNameFor(m => m.telefono)</dt>
        <dd>@Html.DisplayFor(m => m.telefono)</dd>

        <dt>@Html.DisplayNameFor(m => m.correo)</dt>
        <dd>@Html.DisplayFor(m => m.correo)</dd>

        <dt>@Html.DisplayNameFor(m => m.username)</dt>
        <dd>@Html.DisplayFor(m => m.username)</dd>

        <dt>@Html.DisplayNameFor(m => m.idRol)</dt>
        <dd>@Html.DisplayFor(m => m.idRol)</dd>



    </dl>

</div>
@using (Html.BeginForm())
{ 
    @Html.HiddenFor(m => m.idUsuario, new { id = "id" })
    @Html.AntiForgeryToken()
    <input type="button" value="Eliminar" onclick="borrar()" class="btn btn-danger" />
}
@section Scripts{
    <script type="text/javascript">

        function borrar() {
            
            let url = "/Usuario/Borrar";

            fetch(url, {
                method: 'POST',
                body: JSON.stringify({
                    id: document.getElementById("id").value
                }),
                headers: {
                    'Accept': 'application/json',
                    'Content-Type':'application/json'
                }
            }).then((response) => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error("Ha ocurrido un error")
                }
            }).catch(error => {
                alert(error)
            }).then((data) => {
                if (data != "1") {
                    alert("Error iiiii")
                } else {
                    document.location.href = "/Usuario/";
                }
            })

        }


    function jsDel(Id) {
        fetch("/Usuario/Borrar", {
            method: "POST",
            body: JSON.stringify({
                Id: Id
            }),
            headers: {
                'Accept': "application/json",
                "Content-Type": "application/json"
            }
        }).then(function (response) {
            if (response.ok)
                return response.text()
            else
                alert("Error al ejecutar :(")
        }).then(function (Data) {
            if (Data != "1") {
                alert(Data)
            } else {
                location.assign("/Usuario/")
            }
        })
    }
    


    </script>
}
